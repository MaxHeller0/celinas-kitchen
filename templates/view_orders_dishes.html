{% extends "layout.html" %}

{% block title %}
  Orders
{% endblock %}

{% block main %}
  <form class="form-inline" action="{{url_for('view_orders')}}" method="POST">
    <div class="form-group overflow">
      <div class="input-group side_by_side">
        <div class="input-group-addon">Filter by</div>
        <div class="input-group">
          <select class="form-control" name="filter_cat">
            <option value="client">Client</option>
            <option selected="selected" value="dish">Dish</option>
          </select>
        </div>
      </div>
      <div class="input-group side_by_side">
        <div class="input-group-addon">Query:</div>
        <div class="input-group">
          {% if query %}
          <input type="text" list="recipes" name="filter_query" class="form-control" value="{{query}}" placeholder="Dish Name">
          {% else %}
          <input type="text" list="recipes" name="filter_query" class="form-control" placeholder="Dish Name">
          {% endif %}
          <datalist name="recipes" id="recipes">
            {% if recipes %}
              {% for recipe in recipes %}
                <option value="{{recipe.name}}">
              {% endfor %}
            {% endif %}
          </datalist>
        </div>
      </div>
      <div class="input-group side_by_side">
        <div class="input-group-addon">From</div>
        <div class="input-group">
          <select class="form-control" name="time">
            <option value="past_day">Today</option>
            <option value="past_week">Past Week</option>
            <option value="past_month">Past Month</option>
            <option selected="selected" value="all_time">All Time</option>
          </select>
        </div>
      </div>
      <div class="input-group side_by_side">
        <button class="btn btn-default">Filter</button>
      </div>
    </div>
  </form>
  <table>
     <thread>
       <tr>
          <th scope="col">Date</th>
          <th scope="col">Name</th>
          <th scope="col">Quantity</th>
        </tr>
      </thread>
    <tbody>
      {% for order in orders['orders'] %}
      {% for item in order['items'] %}
      {% if not query or item['name'].lower() == query.lower() %}
      <tr>
        <td>{{order['date']}}</td>
        <td>{{order['name']}}</td>
        <td>{{item['count']}}</td>
      </tr>
      {% endif %}
      {% endfor %}
      {% endfor %}
      {% if query %}
      <tr>
        <td></td>
        <td>Total</td>
        <td>{{orders['total']}}</td>
      </tr>
      {% endif %}
    </tbody>
  </table>
{% endblock %}
